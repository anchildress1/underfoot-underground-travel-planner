pre-commit:
  parallel: true
  commands:
    audit-fix:
      run: npm audit fix || true
      stage_fixed: true
    actionlint:
      glob: ".github/workflows/*.yml"
      run: actionlint {staged_files}
    backend-format:
      glob: "backend/**/*.py"
      stage_fixed: true
      run: cd backend && uv run black chat underfoot manage.py tests && uv run ruff check --fix chat underfoot manage.py tests
    backend-lint:
      glob: "backend/**/*.py"
      run: cd backend && uv run ruff check chat underfoot manage.py tests && uv run mypy chat underfoot manage.py
    frontend-format:
      glob: "{frontend,docs}/**/*.{ts,tsx,js,jsx,json,md}"
      stage_fixed: true
      run: npm run format -- {staged_files}
    frontend-lint:
      glob: "frontend/**/*.{ts,tsx,js,jsx}"
      run: npm run lint

pre-push:
  parallel: true
  commands:
    backend-test:
      glob: "backend/**/*.py"
      run: make test-backend
    frontend-test:
      glob: "frontend/**/*.{ts,tsx,js,jsx}"
      run: make test-frontend

commit-msg:
  commands:
    commitlint:
      run: npm run commitlint -- {1}
